

How to use Display Stream Compression (DSC) algorithm model
--------------------------------------------------------------

1)  The typical usage for the DSC model is:

DSC -F <configuration_file>

The configuration_file contains a list of options for the model.  An example is given in test.cfg that is included with the model.  The parameters are listed in the section below.


2)  The configuration file can specify whether the DSC executable behaves as an encoder, decoder, or both using the FUNCTION parameter.  If the FUNCTION is 1, the executable will encode to an output bitstream that is stored in a file (or files) with the same base name and a .dsc extension.  If the FUNCTION is set to 2, the executable will decode a .dsc file (or files) specified.  If .dpx or .ppm files are listed in the input list file instead of .dsc files, the .dsc files will be decoded and PSNR will be calculated as well.  If the FUNCTION is 0, the executable will encode and decode, but no bitstream file will be generated.

A list file (SRC_LIST) is required to indicate which source files to encode.  The list file is also required in decode mode to indicate which .dsc files to decode.  The list file may contain full pathnames.  By default, the model outputs to the current working directory; however, an alternative OUT_DIR can be specified in the config file.  If the same list file is used for encoding and decoding, the PSNR will be calculated between the source file and decoded output.

Parameters besides SRC_LIST and FUNCTION are ignored for the decoder, since the configuration is stored as part of the bitstream file.


3)  Output files to the current working directory:
	- log.txt (or filename specified as LOG_FILENAME) provides PSNR information
	- <name>.ref.dpx is the converted DPX file that represents the encoder input
	- <name>.out.dpx is the decoder output
        - <name>.dsc is the output bitstream if FUNCTION = 1


4)  The included EXE file is compiled under Win32, and some users may experience memory allocation errors for very large pictures.  Compiling the code using "x64" platform target under Windows or compiling under 64-bit Linux will fix these errors.



Configuration file paramters
-----------------------------

FUNCTION - 0=encode and decode (no bitstream file is produced), 1=encode only, 2=decode only

BITS_PER_PIXEL - The constant bit rate of the output stream (bits/pixel).  Can be specified as a floating point number.

BITS_PER_COMPONENT - The input DPX files will be converted to this number of bits per component if they aren't already in that format and coded using this value for bpc.

ENABLE_422 - If set to 1, USE_YUV_INPUT must be set 1.  The input DPX files will be converted to YCbCr 4:2:2 (if they aren't already in that format) and coded that way.  If set to 0, the input DPX files will be converted and coded as 4:4:4.

VBR_ENABLE - Enable VBR mode.

USE_YUV_INPUT - If set 0, the input DPX files will be converted to RGB (if they aren't already in that format) and coded that way.  If set to 1, the input DPX files will be converted to YCbCr (if the aren't already in that format) and coded that way.

SLICE_WIDTH - If specified, sets the width of the rectangular slices.  If unspecified, slices are assumed to be the full picture width.

SLICE_HEIGHT - If specified, sets the height of the rectangular slices.  If unspecified, slices are assumed to be the full picture height.

SWAP_R_AND_B - Allows the swapping of the R & B components of the input files if the DPX file input has incorrect component ordering.

SWAP_R_AND_B_OUT - Allows the swapping of the R & B components of the output files if the DPX viewer has incorrect component ordering.

DPX_BUGS_OVERRIDE - If noncompliant DPX files are input, allows the DPX reader to read them properly.  This is required to be set = 2 for the Sharp images that were generated by ImageMagick.

DPX_WRITE_BSWAP - Write the DPX file endianness the opposite way from the host machine.

SRC_LIST - Specifies a text file that contains the DPX files to be processed (one file name per line).

INCLUDE - Several different include files are used for different rate control settings.  The distribution has recommended settings for 8, 10, and 12 bpc and 8 and 12 bpp.

BLOCK_PRED_ENABLE - Enables block prediction with a range of 8 positions.  A value of 0 disables block prediction.  Block prediction helps certain pathological images but can have a slight negative effect on "typical" content.



DPX Support Notes
------------------
The model supports reading and writing 8, 10, and 12-bit DPX files, and supports reading 16-bit DPX files.  We attempted to follow the SMPTE 268M specification as closely as possible.  Although some testing has been done to try to ensure compatibility, there may be some issues reading certain types of DPX files.  The written DPX files aren't guaranteed to work with any specific DPX reader software.

1)  We chose to support Method A for 10-bit data and Method B for 12- and 16-bit data for both reading & writing.  Other packing methods may fail.

2)  We included support for reading images with common bugs in them.  Please see the description for DPX_BUGS_OVERRIDE in test.cfg for more information.

3)  For writing, we support an option to either pad the end of scan lines to 32-bit boundaries or not.  The spec is not clear on this and some readers expect both configurations.

4)  We always output a .ref.dpx file that contains the image the codec is trying to code.  If your reader doesn't read this file, it won't be able to read the .out.dpx file either.  If you know your DPX reader ordinarily works with the .ref.dpx file, but some particular source image causes problems, there may be a compatibility issue between that source image and the DPX reader.

5)  If YCbCr support and 4:2:2 is not required, the model can also input and output PPM format.  Input files in PPM format will cause the model generate output files in PPM format.
